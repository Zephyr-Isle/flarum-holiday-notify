(()=>{var t={n:a=>{var n=a&&a.__esModule?()=>a.default:()=>a;return t.d(n,{a:n}),n},d:(a,n)=>{for(var e in n)t.o(n,e)&&!t.o(a,e)&&Object.defineProperty(a,e,{enumerable:!0,get:n[e]})},o:(t,a)=>Object.prototype.hasOwnProperty.call(t,a)};(()=>{"use strict";const a=flarum.core.compat["admin/app"];var n=t.n(a);const e=flarum.core.compat["common/app"];var o=t.n(e);function i(t,a){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,a){return t.__proto__=a,t},i(t,a)}function l(t,a){t.prototype=Object.create(a.prototype),t.prototype.constructor=t,i(t,a)}const r=flarum.core.compat["common/Model"];var s=t.n(r);flarum.core.compat["common/utils/mixin"];var d=function(t){function a(){for(var a,n=arguments.length,e=new Array(n),o=0;o<n;o++)e[o]=arguments[o];return(a=t.call.apply(t,[this].concat(e))||this).name=s().attribute("name"),a.identifier=s().attribute("identifier"),a.type=s().attribute("type"),a.month=s().attribute("month"),a.day=s().attribute("day"),a.duration=s().attribute("duration"),a.isEnabled=s().attribute("isEnabled"),a.template=s().attribute("template"),a.createdAt=s().attribute("createdAt",s().transformDate),a.updatedAt=s().attribute("updatedAt",s().transformDate),a}return l(a,t),a}(s());o().initializers.add("zephyrisle-holiday-notify-common",function(){o().store.models["holiday-configs"]=d});const p=flarum.core.compat["admin/components/ExtensionPage"];var h=t.n(p);const y=flarum.core.compat["common/components/Button"];var c=t.n(y);const u=flarum.core.compat["common/components/LoadingIndicator"];var f=t.n(u);const g=flarum.core.compat["common/components/Modal"];var b=t.n(g);const v=flarum.core.compat["common/utils/Stream"];var z=t.n(v),N=function(t){function a(){return t.apply(this,arguments)||this}l(a,t);var n=a.prototype;return n.oninit=function(a){t.prototype.oninit.call(this,a),this.holiday=this.attrs.holiday,this.name=z()(this.holiday?this.holiday.name():""),this.type=z()(this.holiday?this.holiday.type():"gregorian"),this.month=z()(this.holiday?this.holiday.month():1),this.day=z()(this.holiday?this.holiday.day():1),this.template=z()(this.holiday?this.holiday.template():"")},n.className=function(){return"HolidayModal Modal--small"},n.title=function(){return this.holiday?app.translator.trans("zephyrisle-holiday-notify.admin.holidays.edit"):app.translator.trans("zephyrisle-holiday-notify.admin.holidays.create")},n.content=function(){return m("div",{className:"Modal-body"},m("div",{className:"Form-group"},m("label",null,app.translator.trans("zephyrisle-holiday-notify.admin.holidays.name")),m("input",{className:"FormControl",bidi:this.name})),m("div",{className:"Form-group"},m("label",null,app.translator.trans("zephyrisle-holiday-notify.admin.holidays.type")),m("select",{className:"FormControl",bidi:this.type},m("option",{value:"gregorian"},"Gregorian"),m("option",{value:"lunar"},"Lunar"))),m("div",{className:"Form-group"},m("label",null,app.translator.trans("zephyrisle-holiday-notify.admin.holidays.date")," (Month/Day)"),m("div",{className:"HolidayModal-date"},m("input",{className:"FormControl",type:"number",min:"1",max:"12",bidi:this.month,placeholder:"Month"}),m("input",{className:"FormControl",type:"number",min:"1",max:"31",bidi:this.day,placeholder:"Day"}))),m("div",{className:"Form-group"},m("label",null,app.translator.trans("zephyrisle-holiday-notify.admin.holidays.template")),m("textarea",{className:"FormControl",bidi:this.template,placeholder:"Optional custom template. Use {content} for AI generated text."})),m("div",{className:"Form-group"},m(c(),{className:"Button Button--primary",type:"submit",loading:this.loading},app.translator.trans("core.lib.save"))))},n.onsubmit=function(t){var a=this;t.preventDefault(),this.loading=!0;var n={name:this.name(),type:this.type(),month:this.month(),day:this.day(),template:this.template()};this.holiday?this.holiday.save(n).then(function(){return a.hide()}):app.store.createRecord("holiday-configs").save(n).then(function(){a.hide(),a.attrs.onsave&&a.attrs.onsave()})},a}(b()),_=function(t){function a(){return t.apply(this,arguments)||this}l(a,t);var n=a.prototype;return n.oninit=function(a){t.prototype.oninit.call(this,a),this.loading=!0,this.holidays=[],this.refresh()},n.refresh=function(){var t=this;this.loading=!0,app.store.find("holiday-configs").then(function(a){t.holidays=a,t.loading=!1,m.redraw()})},n.content=function(){var t=this;return this.loading?m(f(),null):m("div",{className:"HolidaySettingsPage"},m("div",{className:"container"},m("div",{className:"Form-group"},m("label",null,app.translator.trans("zephyrisle-holiday-notify.admin.settings.openai_section")),m("div",{className:"helpText"},app.translator.trans("zephyrisle-holiday-notify.admin.settings.openai_help")),this.buildSettingComponent({type:"text",setting:"zephyrisle-holiday.openai_url",label:app.translator.trans("zephyrisle-holiday-notify.admin.settings.openai_url"),placeholder:"https://api.openai.com/v1"}),this.buildSettingComponent({type:"password",setting:"zephyrisle-holiday.openai_api_key",label:app.translator.trans("zephyrisle-holiday-notify.admin.settings.openai_api_key")}),this.buildSettingComponent({type:"text",setting:"zephyrisle-holiday.openai_model",label:app.translator.trans("zephyrisle-holiday-notify.admin.settings.openai_model"),placeholder:"gpt-3.5-turbo"})),m("hr",null),m("div",{className:"HolidaySettingsPage-header"},m("h3",null,app.translator.trans("zephyrisle-holiday-notify.admin.holidays.title")),m(c(),{className:"Button Button--primary",onclick:function(){return app.modal.show(N,{onsave:function(){return t.refresh()}})}},app.translator.trans("zephyrisle-holiday-notify.admin.holidays.create"))),m("div",{className:"HolidaySettingsPage-list"},m("table",{className:"HolidayList"},m("thead",null,m("tr",null,m("th",null,app.translator.trans("zephyrisle-holiday-notify.admin.holidays.name")),m("th",null,app.translator.trans("zephyrisle-holiday-notify.admin.holidays.date")),m("th",null,app.translator.trans("zephyrisle-holiday-notify.admin.holidays.type")),m("th",null,app.translator.trans("zephyrisle-holiday-notify.admin.holidays.enabled")),m("th",null,app.translator.trans("zephyrisle-holiday-notify.admin.holidays.actions")))),m("tbody",null,this.holidays.map(function(a){return m("tr",null,m("td",null,a.name()),m("td",null,a.month(),"/",a.day()),m("td",null,a.type()),m("td",null,m("div",{className:"Form-group"},m("input",{type:"checkbox",checked:a.isEnabled(),onchange:function(n){return t.toggleHoliday(a,n.target.checked)}}))),m("td",null,m(c(),{className:"Button Button--icon",icon:"fas fa-edit",onclick:function(){return app.modal.show(N,{holiday:a,onsave:function(){return t.refresh()}})}}),m(c(),{className:"Button Button--icon",icon:"fas fa-trash",onclick:function(){return t.deleteHoliday(a)}})))}))))))},n.toggleHoliday=function(t,a){t.save({isEnabled:a})},n.deleteHoliday=function(t){var a=this;confirm(app.translator.trans("zephyrisle-holiday-notify.admin.holidays.delete_confirm"))&&t.delete().then(function(){return a.refresh()})},a}(h());n().initializers.add("zephyrisle-holiday-notify",function(){n().extensionData.for("zephyrisle-holiday-notify").registerPage(_)})})(),module.exports={}})();
//# sourceMappingURL=admin.js.map